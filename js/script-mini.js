"use strict";var POPUP_BOUNDS_DURATION=300,overlayEl=document.querySelector(".overlay"),feedbackTriggerEl=document.querySelector(".feedback-trigger"),feedbackEl=document.querySelector(".feedback-content"),feedbackFormEl=feedbackEl.querySelector(".feedback-form"),closeFeedbackEl=feedbackEl.querySelector(".popup-close"),inputElts=Array.prototype.slice.call(feedbackEl.querySelectorAll(".feedback-input")),isLocalStorageSupport=!0,errorState=[],mapShowTrigger=document.querySelector(".location-map"),mapEl=document.querySelector(".map-popup"),closeMapEl=mapEl.querySelector(".popup-close"),openFedbackPopup=function(){overlayEl.classList.add("popup-visible"),feedbackEl.classList.add("popup-visible"),feedbackEl.classList.add("feedback-show-up"),feedbackPreset(),feedbackTriggerEl.removeEventListener("click",onFeedbackTriggerClick),mapShowTrigger.removeEventListener("click",onMapTriggerClick),overlayEl.addEventListener("click",onOverlayClick),closeFeedbackEl.addEventListener("click",onClosefeedbackClick),feedbackFormEl.addEventListener("submit",onFormSubmit),feedbackFormEl.addEventListener("input",onInput),document.addEventListener("keydown",onEscKeyDown)},closeFedbackPopup=function(){overlayEl.classList.remove("popup-visible"),feedbackEl.classList.remove("popup-visible","feedback-show-up"),inputElts.forEach(function(e){e.classList.remove("feedback-input--invalid")}),feedbackTriggerEl.addEventListener("click",onFeedbackTriggerClick),mapShowTrigger.addEventListener("click",onMapTriggerClick),overlayEl.removeEventListener("click",onOverlayClick),closeFeedbackEl.removeEventListener("click",onClosefeedbackClick),feedbackFormEl.removeEventListener("submit",onFormSubmit),feedbackFormEl.reset(),document.removeEventListener("keydown",onEscKeyDown)},closePopup=function(){feedbackEl.classList.contains("popup-visible")?closeFedbackPopup():onCloseMapClick()},onEscKeyDown=function(e){"Escape"!==e.key&&"Esc"!==e.key||closePopup()},feedbackPreset=function(){try{inputElts.forEach(function(e){"message"!==e.id&&(e.value=localStorage.getItem(e.id))})}catch(e){isLocalStorageSupport=!1}var c=!1;inputElts.forEach(function(e){e.value||c||(e.focus(),c=!0)})},onInput=function(e){e.target.value&&errorState[e.target.id]?(e.target.classList.remove("feedback-input--invalid"),errorState[e.target.id]=!1):e.target.value||errorState[e.target.id]||(e.target.classList.add("feedback-input--invalid"),errorState[e.target.id]=!0)},onFormSubmit=function(e){e.preventDefault();var c=!0;inputElts.forEach(function(e){e.value?errorState[e.id]=!1:(e.classList.add("feedback-input--invalid"),c=!1,errorState[e.id]=!0)}),c?(isLocalStorageSupport&&inputElts.forEach(function(e){"message"!==e.id&&localStorage.setItem(e.id,e.value)}),feedbackFormEl.submit(),closeFedbackPopup()):(feedbackEl.classList.remove("feedback-show-up"),feedbackEl.classList.add("feedback-content--invalid"),setTimeout(function(){feedbackEl.classList.remove("feedback-content--invalid")},POPUP_BOUNDS_DURATION))},onClosefeedbackClick=function(e){e.preventDefault(),closeFedbackPopup()},onOverlayClick=onClosefeedbackClick,onFeedbackTriggerClick=function(e){e.preventDefault(),openFedbackPopup()},onMapTriggerClick=function(){overlayEl.classList.add("popup-visible"),mapEl.classList.add("popup-visible"),mapEl.classList.add("map-show-up"),mapShowTrigger.removeEventListener("click",onMapTriggerClick),feedbackTriggerEl.removeEventListener("click",onFeedbackTriggerClick),overlayEl.addEventListener("click",onCloseMapClick),closeMapEl.addEventListener("click",onCloseMapClick),document.addEventListener("keydown",onEscKeyDown)},onCloseMapClick=function(){overlayEl.classList.remove("popup-visible"),mapEl.classList.remove("popup-visible","map-show-up"),mapShowTrigger.addEventListener("click",onMapTriggerClick),feedbackTriggerEl.addEventListener("click",onFeedbackTriggerClick),overlayEl.removeEventListener("click",onCloseMapClick),closeMapEl.removeEventListener("click",onCloseMapClick),document.removeEventListener("keydown",onEscKeyDown)};feedbackTriggerEl.addEventListener("click",onFeedbackTriggerClick),mapShowTrigger.addEventListener("click",onMapTriggerClick);